<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AT91SAM3S Demo: SAM-GUI WGT ADS7843 Frontend</title>
<link href="common/style.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
    <div id="body">
        <div id="title">AT91SAM3S Demo 1.3</div>
        <div id="banner"></div>

<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>SAM-GUI WGT ADS7843 Frontend<br/>
<small>
[<a class="el" href="group___s_a_m_g_u_i___w_g_t___c_o_r_e___f_r_o_n_t_e_n_d.html">WGT Core Frontend</a>]</small>
</h1>
<p><div class="dynheader">
Collaboration diagram for SAM-GUI WGT ADS7843 Frontend:</div>
<div class="dynsection">
<center><table><tr><td><img src="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.png" border="0" alt="" usemap="#group______s__a__m__g__u__i______w__g__t______touchscreen____frontend_map"/>
<map name="group______s__a__m__g__u__i______w__g__t______touchscreen____frontend_map" id="group______s__a__m__g__u__i______w__g__t______touchscreen____frontend">
<area shape="rect" id="node1" href="group___s_a_m_g_u_i___w_g_t___c_o_r_e___f_r_o_n_t_e_n_d.html" title="WGT Core Frontend" alt="" coords="5,5,144,35"/></map></td></tr></table></center>
</div>
</p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ads7843_calib_parameters.html">Ads7843CalibParameters</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#gac3232fa82a700a925dd2563705185297">NB_SAMPLES</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#gab64c277271378db4c9320be6210eb4df">SAMPLING_PERIOD</a>&nbsp;&nbsp;&nbsp;10</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#ga760d57a472dd7d7d1a2dade244e9cbc6">_WFE_ADS7843_GetPenPosition</a> (uint32_t *pdwX, uint32_t *pdwY)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns Touchscreen pen position Performs several (NB_SAMPLES succesive measurements and do a mean. Then calibration function is applied according to the calibration parameters.  <a href="#ga760d57a472dd7d7d1a2dade244e9cbc6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#gae947d7272149a73c671ccc80a34a9946">_WFE_ADS7843_Task</a> (void *pParameter)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Touch screen sampling task.  <a href="#gae947d7272149a73c671ccc80a34a9946"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#gad552f2b780929f70e65b3beded6aea6c">gTsCalibrated</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="struct_ads7843_calib_parameters.html">Ads7843CalibParameters</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#ga34c68408290e6e28eec0c14635f078af">gs_ADS7843CalibParameters</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const Pin&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#ga7abe7dd797a85661a1e03b0b9532f722">_WFE_ADS7843_pinPenIRQ</a> = PIN_TCS_IRQ</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static xSemaphoreHandle&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#gaa88e33eec1dd3a1311b8f9f3576f5c37">gTsSemaphore</a> = NULL</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="struct_s_w_g_t_frontend.html">SWGTFrontend</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#ga10aff4f9afa3af13379d2ea61782e177">sWGT_Frontend_ADS7843</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The Touchscreen driver posts messages to the Widget message queue: </p>
<ul>
<li>
WGT_MSG_POINTER_RAW: pen pressed, provides uncalibrated-filtered pen position.  </li>
<li>
WGT_MSG_POINTER_PRESSED: pen pressed, provides calibrated-filtered pen position. </li>
<li>
WGT_MSG_POINTER: pen moved, provides calibrated-filtered pen position. </li>
<li>
<p class="startli">WGT_MSG_POINTER_RELEASED: pen released, provides calibrated-filtered pen position. <br/>
</p>
<p>Touchscreen ADS7843 is connected to the microcontroller through SPI and an a signal connected to a PIO corresponding to the pen press detection. Each time a pen press is detected, the microcontroller is notified through the interrupt line triggering a PIO interrupt. <br/>
</p>
<p>The touchscreen driver starts a task suspended until the PIO interrupt handler releases a semaphore. Then the task does measurements until the pen is detected as released. Once the pen is released, the task enters in suspend mode, waiting to get the semaphore ie. waiting for the next pen press detection.</p>
<p class="endli">Related files :<br/>
 ads7843::c<br/>
 ads7843::h<br/>
 </p>
</li>
</ul>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="gac3232fa82a700a925dd2563705185297"></a><!-- doxytag: member="frontend_ADS7843.c::NB_SAMPLES" ref="gac3232fa82a700a925dd2563705185297" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NB_SAMPLES&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of succesive measurements required to get an accurate pen position </p>

</div>
</div>
<a class="anchor" id="gab64c277271378db4c9320be6210eb4df"></a><!-- doxytag: member="frontend_ADS7843.c::SAMPLING_PERIOD" ref="gab64c277271378db4c9320be6210eb4df" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SAMPLING_PERIOD&nbsp;&nbsp;&nbsp;10</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sampling period (in ms) when pen is pressed to detect pen mouvements </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga760d57a472dd7d7d1a2dade244e9cbc6"></a><!-- doxytag: member="frontend_ADS7843.c::_WFE_ADS7843_GetPenPosition" ref="ga760d57a472dd7d7d1a2dade244e9cbc6" args="(uint32_t *pdwX, uint32_t *pdwY)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void _WFE_ADS7843_GetPenPosition </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&nbsp;</td>
          <td class="paramname"> <em>pdwX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&nbsp;</td>
          <td class="paramname"> <em>pdwY</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns Touchscreen pen position Performs several (NB_SAMPLES succesive measurements and do a mean. Then calibration function is applied according to the calibration parameters. </p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend_ga760d57a472dd7d7d1a2dade244e9cbc6_icgraph.png" border="0" usemap="#group___s_a_m_g_u_i___w_g_t___touchscreen__frontend_ga760d57a472dd7d7d1a2dade244e9cbc6_icgraph_map" alt=""></div>
<map name="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend_ga760d57a472dd7d7d1a2dade244e9cbc6_icgraph_map" id="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend_ga760d57a472dd7d7d1a2dade244e9cbc6_icgraph">
<area shape="rect" id="node3" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#gae947d7272149a73c671ccc80a34a9946" title="Touch screen sampling task." alt="" coords="273,5,428,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gae947d7272149a73c671ccc80a34a9946"></a><!-- doxytag: member="frontend_ADS7843.c::_WFE_ADS7843_Task" ref="gae947d7272149a73c671ccc80a34a9946" args="(void *pParameter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void _WFE_ADS7843_Task </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>pParameter</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Touch screen sampling task. </p>
<p>This task is resumed when a PIO interrupt release the semaphore, that's to say when the pen is pressed. Then this task reports pen activity each SAMPLING_RATE period until the pen is released </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend_gae947d7272149a73c671ccc80a34a9946_cgraph.png" border="0" usemap="#group___s_a_m_g_u_i___w_g_t___touchscreen__frontend_gae947d7272149a73c671ccc80a34a9946_cgraph_map" alt=""></div>
<map name="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend_gae947d7272149a73c671ccc80a34a9946_cgraph_map" id="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend_gae947d7272149a73c671ccc80a34a9946_cgraph">
<area shape="rect" id="node3" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#ga760d57a472dd7d7d1a2dade244e9cbc6" title="Returns Touchscreen pen position Performs several (NB_SAMPLES succesive measurements..." alt="" coords="211,5,429,35"/><area shape="rect" id="node5" href="group___s_a_m_g_u_i___w_g_t___c_o_r_e___m_e_s_s_a_g_e_s.html#ga590960702ede86bc1dcff5357c829bc9" title="WGT_SendMessageISR" alt="" coords="239,59,401,88"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ga7abe7dd797a85661a1e03b0b9532f722"></a><!-- doxytag: member="frontend_ADS7843.c::_WFE_ADS7843_pinPenIRQ" ref="ga7abe7dd797a85661a1e03b0b9532f722" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Pin <a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#ga7abe7dd797a85661a1e03b0b9532f722">_WFE_ADS7843_pinPenIRQ</a> = PIN_TCS_IRQ<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Pins used by Interrupt Signal for Touch Screen Controller </p>

</div>
</div>
<a class="anchor" id="ga34c68408290e6e28eec0c14635f078af"></a><!-- doxytag: member="frontend_ADS7843.c::gs_ADS7843CalibParameters" ref="ga34c68408290e6e28eec0c14635f078af" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_ads7843_calib_parameters.html">Ads7843CalibParameters</a> <a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#ga34c68408290e6e28eec0c14635f078af">gs_ADS7843CalibParameters</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="gad552f2b780929f70e65b3beded6aea6c"></a><!-- doxytag: member="frontend_ADS7843.c::gTsCalibrated" ref="gad552f2b780929f70e65b3beded6aea6c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#gad552f2b780929f70e65b3beded6aea6c">gTsCalibrated</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Binary flag to check if the screen has been calibrated. Calibration calculus is not applied since this flag is not true. Only raw values are sent to the application until the calibration has been done </p>

</div>
</div>
<a class="anchor" id="gaa88e33eec1dd3a1311b8f9f3576f5c37"></a><!-- doxytag: member="frontend_ADS7843.c::gTsSemaphore" ref="gaa88e33eec1dd3a1311b8f9f3576f5c37" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">xSemaphoreHandle <a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#gaa88e33eec1dd3a1311b8f9f3576f5c37">gTsSemaphore</a> = NULL<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Touch screen semaphore used to resume touch screen task when pen is pressed </p>

</div>
</div>
<a class="anchor" id="ga10aff4f9afa3af13379d2ea61782e177"></a><!-- doxytag: member="frontend_ADS7843.h::sWGT_Frontend_ADS7843" ref="ga10aff4f9afa3af13379d2ea61782e177" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="struct_s_w_g_t_frontend.html">SWGTFrontend</a> <a class="el" href="group___s_a_m_g_u_i___w_g_t___touchscreen__frontend.html#ga10aff4f9afa3af13379d2ea61782e177">sWGT_Frontend_ADS7843</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Mon Dec 21 04:54:05 2009 for AT91SAM3S Demo by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
